<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LoveSync - Premium Dating Experience</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
    <script src="https://js.paystack.co/v1/inline.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/peerjs@1.4.7/dist/peerjs.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.socket.io/4.7.2/socket.io.min.js"></script>
    <style>
        .gradient-bg {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        .card-hover {
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        .card-hover:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1);
        }
        .swipe-card {
            transition: transform 0.3s ease;
        }
        .swipe-left {
            transform: translateX(-100%) rotate(-30deg);
        }
        .swipe-right {
            transform: translateX(100%) rotate(30deg);
        }
    </style>
</head>
<body class="bg-gray-50">
    <div id="root"></div>
    
    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        const App = () => {
            const [user, setUser] = useState(null);
            const [isAuthenticated, setIsAuthenticated] = useState(false);
            const [page, setPage] = useState('login');
            const [profiles, setProfiles] = useState([]);
            const [currentProfileIndex, setCurrentProfileIndex] = useState(0);
            const [matches, setMatches] = useState([]);
            const [messages, setMessages] = useState([]);
            const [currentMatch, setCurrentMatch] = useState(null);
            const [subscriptionPlans, setSubscriptionPlans] = useState({});
            const [swipeAnimation, setSwipeAnimation] = useState('');
            const [socket, setSocket] = useState(null);
            const [peer, setPeer] = useState(null);
            const [call, setCall] = useState(null);
            const videoRef = useRef(null);
            const remoteVideoRef = useRef(null);

            // Initialize Socket.IO
            useEffect(() => {
                const newSocket = io();
                setSocket(newSocket);
                
                newSocket.on('receive_message', (message) => {
                    setMessages(prev => [...prev, message]);
                });

                return () => newSocket.close();
            }, []);

            // Initialize PeerJS
            useEffect(() => {
                if (user) {
                    const newPeer = new Peer();
                    setPeer(newPeer);
                    
                    newPeer.on('open', (id) => {
                        console.log('Peer ID:', id);
                    });
                    
                    newPeer.on('call', (incomingCall) => {
                        navigator.mediaDevices.getUserMedia({ video: true, audio: true })
                            .then(stream => {
                                videoRef.current.srcObject = stream;
                                incomingCall.answer(stream);
                                incomingCall.on('stream', remoteStream => {
                                    remoteVideoRef.current.srcObject = remoteStream;
                                });
                                setCall(incomingCall);
                            });
                    });
                }
            }, [user]);

            // Check for existing token
            useEffect(() => {
                const token = localStorage.getItem('lovesync_token');
                if (token) {
                    axios.defaults.headers.common['Authorization'] = `Bearer ${token}`;
                    // Verify token by fetching user profile
                    fetchProfiles();
                }
            }, []);

            // Fetch subscription plans
            useEffect(() => {
                fetchSubscriptionPlans();
            }, []);

            const fetchSubscriptionPlans = async () => {
                try {
                    const response = await axios.get('/api/subscription/plans');
                    setSubscriptionPlans(response.data);
                } catch (error) {
                    console.error('Error fetching plans:', error);
                }
            };

            const fetchProfiles = async () => {
                try {
                    const response = await axios.get('/api/profiles');
                    setProfiles(response.data.profiles);
                    setUser(prev => ({ ...prev, swipe_count: response.data.swipe_count }));
                    setIsAuthenticated(true);
                    if (page === 'login') setPage('home');
                } catch (error) {
                    console.error('Error fetching profiles:', error);
                    localStorage.removeItem('lovesync_token');
                    delete axios.defaults.headers.common['Authorization'];
                }
            };

            const fetchMatches = async () => {
                try {
                    const response = await axios.get('/api/matches');
                    setMatches(response.data.matches);
                } catch (error) {
                    console.error('Error fetching matches:', error);
                }
            };

            const fetchMessages = async (matchId) => {
                try {
                    const response = await axios.get(`/api/messages/${matchId}`);
                    setMessages(response.data.messages);
                } catch (error) {
                    console.error('Error fetching messages:', error);
                }
            };

            const handleLogin = async (e) => {
                e.preventDefault();
                const formData = new FormData(e.target);
                const data = Object.fromEntries(formData);
                
                try {
                    const response = await axios.post('/api/auth/login', data);
                    const { token, user: userData } = response.data;
                    
                    localStorage.setItem('lovesync_token', token);
                    axios.defaults.headers.common['Authorization'] = `Bearer ${token}`;
                    setUser(userData);
                    setIsAuthenticated(true);
                    
                    if (userData.profile.name) {
                        setPage('home');
                        fetchProfiles();
                    } else {
                        setPage('profile');
                    }
                } catch (error) {
                    alert('Login failed: ' + (error.response?.data?.message || 'Unknown error'));
                }
            };

            const handleSignup = async (e) => {
                e.preventDefault();
                const formData = new FormData(e.target);
                const data = Object.fromEntries(formData);
                
                try {
                    const response = await axios.post('/api/auth/signup', data);
                    const { token, user: userData } = response.data;
                    
                    localStorage.setItem('lovesync_token', token);
                    axios.defaults.headers.common['Authorization'] = `Bearer ${token}`;
                    setUser(userData);
                    setIsAuthenticated(true);
                    setPage('profile');
                } catch (error) {
                    alert('Signup failed: ' + (error.response?.data?.message || 'Unknown error'));
                }
            };

            const handleProfileSubmit = async (e) => {
                e.preventDefault();
                const formData = new FormData(e.target);
                const data = Object.fromEntries(formData);
                
                // Convert age and income to numbers
                data.age = parseInt(data.age);
                data.income = parseInt(data.income);
                
                try {
                    await axios.post('/api/profile', data);
                    setUser(prev => ({ ...prev, profile: { ...prev.profile, ...data } }));
                    setPage('home');
                    fetchProfiles();
                } catch (error) {
                    alert('Profile update failed: ' + (error.response?.data?.message || 'Unknown error'));
                }
            };

            const handleSwipe = async (direction) => {
                if (!profiles[currentProfileIndex]) return;
                
                const profileId = profiles[currentProfileIndex].id;
                setSwipeAnimation(direction === 'right' ? 'swipe-right' : 'swipe-left');
                
                setTimeout(async () => {
                    try {
                        const response = await axios.post('/api/swipe', {
                            target_user_id: profileId,
                            direction: direction
                        });
                        
                        if (response.data.needs_payment) {
                            handleMaleSubscription();
                        } else {
                            if (response.data.is_match) {
                                alert('ðŸŽ‰ It\'s a match!');
                                fetchMatches();
                            }
                            setCurrentProfileIndex(prev => prev + 1);
                            setUser(prev => ({ ...prev, swipe_count: response.data.swipe_count }));
                        }
                    } catch (error) {
                        console.error('Swipe error:', error);
                    }
                    setSwipeAnimation('');
                }, 300);
            };

            const handleSubscription = (planId, price) => {
                const handler = PaystackPop.setup({
                    key: 'pk_live_669ad09183f1ded9229c99297d5d67f539e3c828',
                    email: user.email,
                    amount: price,
                    currency: 'NGN',
                    callback: async (response) => {
                        try {
                            await axios.post('/api/subscription/verify', {
                                reference: response.reference,
                                plan_id: planId
                            });
                            alert('Subscription updated successfully!');
                            setUser(prev => ({ ...prev, subscription: planId }));
                            fetchProfiles();
                        } catch (error) {
                            alert('Subscription verification failed');
                        }
                    },
                    onClose: () => {
                        console.log('Payment cancelled');
                    }
                });
                handler.openIframe();
            };

            const handleMaleSubscription = () => {
                handleSubscription('male_unlimited', 99900); // â‚¦999
            };

            const sendMessage = (e) => {
                e.preventDefault();
                const content = e.target.message.value.trim();
                if (!content || !currentMatch) return;
                
                const messageData = {
                    sender_id: user.id,
                    receiver_id: currentMatch.user.id,
                    content: content
                };
                
                socket.emit('send_message', messageData);
                e.target.reset();
            };

            const startVideoCall = async () => {
                if (!peer || !currentMatch) return;
                
                try {
                    const stream = await navigator.mediaDevices.getUserMedia({ video: true, audio: true });
                    videoRef.current.srcObject = stream;
                    
                    const call = peer.call(currentMatch.user.peer_id, stream);
                    call.on('stream', (remoteStream) => {
                        remoteVideoRef.current.srcObject = remoteStream;
                    });
                    setCall(call);
                } catch (error) {
                    console.error('Video call error:', error);
                    alert('Could not start video call');
                }
            };

            const logout = () => {
                localStorage.removeItem('lovesync_token');
                delete axios.defaults.headers.common['Authorization'];
                setUser(null);
                setIsAuthenticated(false);
                setPage('login');
                if (socket) socket.disconnect();
                if (peer) peer.destroy();
            };

            // Render login page
            if (page === 'login') {
                return (
                    <div className="min-h-screen gradient-bg flex items-center justify-center px-4">
                        <div className="max-w-md w-full bg-white rounded-2xl shadow-2xl p-8">
                            <div className="text-center mb-8">
                                <h1 className="text-4xl font-bold text-gray-800 mb-2">LoveSync</h1>
                                <p className="text-gray-600">Premium Dating Experience</p>
                            </div>
                            
                            <form onSubmit={handleLogin} className="space-y-6">
                                <div>
                                    <input
                                        name="email"
                                        type="email"
                                        placeholder="Email"
                                        className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent"
                                        required
                                    />
                                </div>
                                <div>
                                    <input
                                        name="password"
                                        type="password"
                                        placeholder="Password"
                                        className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent"
                                        required
                                    />
                                </div>
                                <button
                                    type="submit"
                                    className="w-full bg-purple-600 text-white py-3 rounded-lg font-semibold hover:bg-purple-700 transition duration-200"
                                >
                                    Login
                                </button>
                            </form>
                            
                            <div className="mt-6 text-center">
                                <button
                                    onClick={() => setPage('signup')}
                                    className="text-purple-600 hover:text-purple-800 font-medium"
                                >
                                    Don't have an account? Sign up
                                </button>
                            </div>
                        </div>
                    </div>
                );
            }

            // Render signup page
            if (page === 'signup') {
                return (
                    <div className="min-h-screen gradient-bg flex items-center justify-center px-4">
                        <div className="max-w-md w-full bg-white rounded-2xl shadow-2xl p-8">
                            <div className="text-center mb-8">
                                <h1 className="text-4xl font-bold text-gray-800 mb-2">Join LoveSync</h1>
                                <p className="text-gray-600">Find your perfect match</p>
                            </div>
                            
                            <form onSubmit={handleSignup} className="space-y-6">
                                <div>
                                    <input
                                        name="email"
                                        type="email"
                                        placeholder="Email"
                                        className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent"
                                        required
                                    />
                                </div>
                                <div>
                                    <input
                                        name="password"
                                        type="password"
                                        placeholder="Password"
                                        className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent"
                                        required
                                    />
                                </div>
                                <div>
                                    <select
                                        name="gender"
                                        className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent"
                                        required
                                    >
                                        <option value="">Select Gender</option>
                                        <option value="male">Male</option>
                                        <option value="female">Female</option>
                                    </select>
                                </div>
                                <button
                                    type="submit"
                                    className="w-full bg-purple-600 text-white py-3 rounded-lg font-semibold hover:bg-purple-700 transition duration-200"
                                >
                                    Sign Up
                                </button>
                            </form>
                            
                            <div className="mt-6 text-center">
                                <button
                                    onClick={() => setPage('login')}
                                    className="text-purple-600 hover:text-purple-800 font-medium"
                                >
                                    Already have an account? Login
                                </button>
                            </div>
                        </div>
                    </div>
                );
            }

            // Render profile setup page
            if (page === 'profile') {
                return (
                    <div className="min-h-screen bg-gray-50 py-8 px-4">
                        <div className="max-w-2xl mx-auto bg-white rounded-2xl shadow-xl p-8">
                            <h2 className="text-3xl font-bold text-gray-800 mb-8 text-center">Complete Your Profile</h2>
                            
                            <form onSubmit={handleProfileSubmit} className="space-y-6">
                                <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                                    <div>
                                        <label className="block text-sm font-medium text-gray-700 mb-2">Name</label>
                                        <input
                                            name="name"
                                            type="text"
                                            className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500"
                                            required
                                        />
                                    </div>
                                    <div>
                                        <label className="block text-sm font-medium text-gray-700 mb-2">Age</label>
                                        <input
                                            name="age"
                                            type="number"
                                            min="18"
                                            max="100"
                                            className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500"
                                            required
                                        />
                                    </div>
                                </div>
                                
                                <div>
                                    <label className="block text-sm font-medium text-gray-700 mb-2">Bio</label>
                                    <textarea
                                        name="bio"
                                        rows="3"
                                        className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500"
                                        placeholder="Tell us about yourself..."
                                        required
                                    ></textarea>
                                </div>
                                
                                <div>
                                    <label className="block text-sm font-medium text-gray-700 mb-2">Interests</label>
                                    <input
                                        name="interests"
                                        type="text"
                                        className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500"
                                        placeholder="e.g., Travel, Music, Sports"
                                        required
                                    />
                                </div>
                                
                                <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                                    <div>
                                        <label className="block text-sm font-medium text-gray-700 mb-2">Occupation</label>
                                        <input
                                            name="occupation"
                                            type="text"
                                            className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500"
                                            required
                                        />
                                    </div>
                                    <div>
                                        <label className="block text-sm font-medium text-gray-700 mb-2">Annual Income (USD)</label>
                                        <input
                                            name="income"
                                            type="number"
                                            min="0"
                                            className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500"
                                            required
                                        />
                                    </div>
                                </div>
                                
                                <div>
                                    <label className="block text-sm font-medium text-gray-700 mb-2">Location</label>
                                    <input
                                        name="location"
                                        type="text"
                                        className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500"
                                        placeholder="City, Country"
                                        required
                                    />
                                </div>
                                
                                <button
                                    type="submit"
                                    className="w-full bg-purple-600 text-white py-3 rounded-lg font-semibold hover:bg-purple-700 transition duration-200"
                                >
                                    Save Profile
                                </button>
                            </form>
                        </div>
                    </div>
                );
            }

            // Main app layout
            return (
                <div className="min-h-screen bg-gray-50">
                    {/* Navigation */}
                    <nav className="bg-white shadow-lg">
                        <div className="max-w-7xl mx-auto px-4">
                            <div className="flex justify-between items-center py-4">
                                <h1 className="text-2xl font-bold text-purple-600">LoveSync</h1>
                                <div className="flex space-x-4">
                                    <button
                                        onClick={() => setPage('home')}
                                        className={`px-4 py-2 rounded-lg font-medium ${page === 'home' ? 'bg-purple-600 text-white' : 'text-gray-600 hover:text-purple-600'}`}
                                    >
                                        Discover
                                    </button>
                                    <button
                                        onClick={() => { setPage('matches'); fetchMatches(); }}
                                        className={`px-4 py-2 rounded-lg font-medium ${page === 'matches' ? 'bg-purple-600 text-white' : 'text-gray-600 hover:text-purple-600'}`}
                                    >
                                        Matches
                                    </button>
                                    <button
                                        onClick={() => setPage('subscription')}
                                        className={`px-4 py-2 rounded-lg font-medium ${page === 'subscription' ? 'bg-purple-600 text-white' : 'text-gray-600 hover:text-purple-600'}`}
                                    >
                                        Premium
                                    </button>
                                    <button
                                        onClick={logout}
                                        className="px-4 py-2 rounded-lg font-medium text-red-600 hover:bg-red-50"
                                    >
                                        Logout
                                    </button>
                                </div>
                            </div>
                        </div>
                    </nav>

                    {/* Home/Discover Page */}
                    {page === 'home' && (
                        <div className="max-w-md mx-auto py-8 px-4">
                            <div className="text-center mb-6">
                                <h2 className="text-2xl font-bold text-gray-800 mb-2">Discover</h2>
                                {user?.gender === 'male' && (
                                    <p className="text-gray-600">Swipes: {user.swipe_count}/25</p>
                                )}
                            </div>
                            
                            {profiles[currentProfileIndex] ? (
                                <div className={`bg-white rounded-2xl shadow-xl overflow-hidden swipe-card ${swipeAnimation}`}>
                                    <div className="h-96 bg-gradient-to-br from-purple-400 to-pink-400 flex items-center justify-center">
                                        <div className="text-white text-6xl">ðŸ‘¤</div>
                                    </div>
                                    <div className="p-6">
                                        <h3 className="text-2xl font-bold text-gray-800 mb-2">
                                            {profiles[currentProfileIndex].name}, {profiles[currentProfileIndex].age}
                                        </h3>
                                        <p className="text-gray-600 mb-2">{profiles[currentProfileIndex].occupation}</p>
                                        <p className="text-gray-600 mb-2">{profiles[currentProfileIndex].location}</p>
                                        <p className="text-gray-700 mb-4">{profiles[currentProfileIndex].bio}</p>
                                        <div className="flex flex-wrap gap-2 mb-4">
                                            {profiles[currentProfileIndex].interests?.split(',').map((interest, index) => (
                                                <span key={index} className="px-3 py-1 bg-purple-100 text-purple-600 rounded-full text-sm">
                                                    {interest.trim()}
                                                </span>
                                            ))}
                                        </div>
                                        <div className="flex justify-center space-x-4">
                                            <button
                                                onClick={() => handleSwipe('left')}
                                                className="w-16 h-16 bg-red-500 text-white rounded-full flex items-center justify-center text-2xl hover:bg-red-600 transition duration-200"
                                            >
                                                âœ•
                                            </button>
                                            <button
                                                onClick={() => handleSwipe('right')}
                                                className="w-16 h-16 bg-green-500 text-white rounded-full flex items-center justify-center text-2xl hover:bg-green-600 transition duration-200"
                                            >
                                                â™¥
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            ) : (
                                <div className="text-center py-12">
                                    <div className="text-6xl mb-4">ðŸŽ‰</div>
                                    <h3 className="text-xl font-semibold text-gray-800 mb-2">No more profiles!</h3>
                                    <p className="text-gray-600">Check back later for new matches</p>
                                </div>
                            )}
                        </div>
                    )}

                    {/* Matches Page */}
                    {page === 'matches' && (
                        <div className="max-w-4xl mx-auto py-8 px-4">
                            <h2 className="text-3xl font-bold text-gray-800 mb-8 text-center">Your Matches</h2>
                            
                            {currentMatch ? (
                                <div className="bg-white rounded-2xl shadow-xl p-6">
                                    <div className="flex items-center justify-between mb-6">
                                        <div className="flex items-center space-x-4">
                                            <div className="w-12 h-12 bg-purple-400 rounded-full flex items-center justify-center text-white text-xl">
                                                ðŸ‘¤
                                            </div>
                                            <div>
                                                <h3 className="text-xl font-semibold">{currentMatch.user.name}</h3>
                                                <p className="text-gray-600">Age {currentMatch.user.age}</p>
                                            </div>
                                        </div>
                                        <div className="flex space-x-2">
                                            <button
                                                onClick={startVideoCall}
                                                className="px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600"
                                            >
                                                ðŸ“¹ Video Call
                                            </button>
                                            <button
                                                onClick={() => setCurrentMatch(null)}
                                                className="px-4 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600"
                                            >
                                                Back
                                            </button>
                                        </div>
                                    </div>
                                    
                                    <div className="h-96 overflow-y-auto mb-4 p-4 bg-gray-50 rounded-lg">
                                        {messages.map((message, index) => (
                                            <div
                                                key={index}
                                                className={`mb-3 ${message.sender_id === user.id ? 'text-right' : 'text-left'}`}
                                            >
                                                <div
                                                    className={`inline-block px-4 py-2 rounded-lg max-w-xs ${
                                                        message.sender_id === user.id
                                                            ? 'bg-purple-600 text-white'
                                                            : 'bg-white text-gray-800'
                                                    }`}
                                                >
                                                    {message.content}
                                                </div>
                                            </div>
                                        ))}
                                    </div>
                                    
                                    <form onSubmit={sendMessage} className="flex space-x-2">
                                        <input
                                            name="message"
                                            type="text"
                                            placeholder="Type a message..."
                                            className="flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500"
                                            required
                                        />
                                        <button
                                            type="submit"
                                            className="px-6 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700"
                                        >
                                            Send
                                        </button>
                                    </form>
                                    
                                    {call && (
                                        <div className="mt-6 grid grid-cols-2 gap-4">
                                            <video ref={videoRef} autoPlay muted className="w-full rounded-lg" />
                                            <video ref={remoteVideoRef} autoPlay className="w-full rounded-lg" />
                                        </div>
                                    )}
                                </div>
                            ) : (
                                <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                                    {matches.map((match) => (
                                        <div
                                            key={match.id}
                                            onClick={() => {
                                                setCurrentMatch(match);
                                                fetchMessages(match.id);
                                                if (socket) {
                                                    socket.emit('join_room', {
                                                        room: `${Math.min(user.id, match.user.id)}_${Math.max(user.id, match.user.id)}`
                                                    });
                                                }
                                            }}
                                            className="bg-white rounded-xl shadow-lg p-6 cursor-pointer card-hover"
                                        >
                                            <div className="w-16 h-16 bg-purple-400 rounded-full flex items-center justify-center text-white text-2xl mx-auto mb-4">
                                                ðŸ‘¤
                                            </div>
                                            <h3 className="text-xl font-semibold text-center mb-2">{match.user.name}</h3>
                                            <p className="text-gray-600 text-center">Age {match.user.age}</p>
                                            {match.last_message.content && (
                                                <p className="text-gray-500 text-sm text-center mt-2 truncate">
                                                    {match.last_message.content}
                                                </p>
                                            )}
                                        </div>
                                    ))}
                                    
                                    {matches.length === 0 && (
                                        <div className="col-span-full text-center py-12">
                                            <div className="text-6xl mb-4">ðŸ’”</div>
                                            <h3 className="text-xl font-semibold text-gray-800 mb-2">No matches yet</h3>
                                            <p className="text-gray-600">Keep swiping to find your perfect match!</p>
                                        </div>
                                    )}
                                </div>
                            )}
                        </div>
                    )}

                    {/* Subscription Page */}
                    {page === 'subscription' && (
                        <div className="max-w-6xl mx-auto py-8 px-4">
                            <div className="text-center mb-12">
                                <h2 className="text-4xl font-bold text-gray-800 mb-4">Choose Your Plan</h2>
                                <p className="text-xl text-gray-600">Unlock premium features and find your perfect match</p>
                            </div>
                            
                            {user?.gender === 'male' && (
                                <div className="mb-12">
                                    <h3 className="text-2xl font-bold text-gray-800 mb-6 text-center">For Men</h3>
                                    <div className="max-w-md mx-auto">
                                        <div className="bg-white rounded-2xl shadow-xl p-8 card-hover">
                                            <div className="text-center">
                                                <h4 className="text-2xl font-bold text-gray-800 mb-2">Unlimited Swipes</h4>
                                                <div className="text-4xl font-bold text-purple-600 mb-4">â‚¦999</div>
                                                <p className="text-gray-600 mb-6">30 days of unlimited right swipes</p>
                                                <ul className="text-left space-y-2 mb-8">
                                                    <li className="flex items-center">
                                                        <span className="text-green-500 mr-2">âœ“</span>
                                                        Unlimited right swipes
                                                    </li>
                                                    <li className="flex items-center">
                                                        <span className="text-green-500 mr-2">âœ“</span>
                                                        See who liked you
                                                    </li>
                                                    <li className="flex items-center">
                                                        <span className="text-green-500 mr-2">âœ“</span>
                                                        Priority matching
                                                    </li>
                                                </ul>
                                                <button
                                                    onClick={() => handleSubscription('male_unlimited', 99900)}
                                                    className="w-full bg-purple-600 text-white py-3 rounded-lg font-semibold hover:bg-purple-700 transition duration-200"
                                                >
                                                    Subscribe Now
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            )}
                            
                            {user?.gender === 'female' && subscriptionPlans.female && (
                                <div>
                                    <h3 className="text-2xl font-bold text-gray-800 mb-6 text-center">For Women</h3>
                                    <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
                                        {subscriptionPlans.female.map((plan) => (
                                            <div key={plan.id} className="bg-white rounded-2xl shadow-xl p-6 card-hover">
                                                <div className="text-center">
                                                    <h4 className="text-xl font-bold text-gray-800 mb-2">{plan.name}</h4>
                                                    <div className="text-3xl font-bold text-purple-600 mb-4">
                                                        â‚¦{(plan.price / 100).toLocaleString()}
                                                    </div>
                                                    <p className="text-gray-600 mb-6 text-sm">{plan.description}</p>
                                                    <button
                                                        onClick={() => handleSubscription(plan.id, plan.price)}
                                                        className="w-full bg-purple-600 text-white py-2 rounded-lg font-semibold hover:bg-purple-700 transition duration-200"
                                                    >
                                                        Choose Plan
                                                    </button>
                                                </div>
                                            </div>
                                        ))}
                                    </div>
                                </div>
                            )}
                        </div>
                    )}
                </div>
            );
        };

        ReactDOM.render(<App />, document.getElementById('root'));
    </script>
</body>
</html>

